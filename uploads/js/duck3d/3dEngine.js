function Scene3D(t){this.groups=new Array,this.perspective=null==t?300:t,this.alphaBackLimit=100,this.alphaFrontLimit=-100,this.soundRadiusFactor=5,this.showPoints=!0,this.showObjects=!0,this.doZClipping=!1}function Group3D(t,i,s,o){this.points=new Array,this.objects=new Array,this.x=0==i?0:i,this.y=0==s?0:s,this.z=0==o?0:o,this.centerPoint=new Vector3D(this.x,this.y,this.z),this.xrot=0,this.yrot=0,this.zrot=0,this.xscale=1,this.yscale=1,this.zscale=1,this.axis=new Object,this.axis.x=new Vector3D(1,0,0),this.axis.y=new Vector3D(0,1,0),this.axis.z=new Vector3D(0,0,1),this.translation=null,this.rotation=null,this.scaling=null,t.addGroup(this),this.scene=t}function Point3D(t,i,s,o){this.group=o,this.local=new Vector3D(t,i,s),this.x=t,this.y=i,this.z=s,this.transformation=null,this.xReal=null,this.yReal=null,this.alphaReal=null,this.scaleReal=null}function Vector3D(t,i,s){this.x=t,this.y=i,this.z=s}function Rotation3D(t,i){var s=t.x,o=t.y,r=t.z,n=Math.sqrt(s*s+o*o+r*r);0!=n?(s/=n,o/=n,r/=n):(s=1,o=0,r=0,i=0);var h=Math.sin(i),a=Math.cos(i),e=1-a,p=s*h,c=o*h,u=r*h,l=s*e,f=o*e,y=r*e;this.m_0_0=s*l+a,this.m_0_1=o*l-u,this.m_0_2=r*l+c,this.m_1_0=s*f+u,this.m_1_1=o*f+a,this.m_1_2=r*f-p,this.m_2_0=s*y-c,this.m_2_1=o*y+p,this.m_2_2=r*y+a}function Scaling3D(t){this.factor=t}function Translation3D(t,i,s){this.distx=t,this.disty=i,this.distz=s}function vorzeichen(){return Math.random()>.5?-1:1}Scene3D.prototype.addGroup=function(t){this.groups.push(t)},Scene3D.prototype.removeGroup=function(t){for(var i=0;i<this.groups.length;i++)if(this.groups[i]==t){if(i!=this.groups.length-1)return this.groups[i]=this.groups.pop(),!0;var s=this.groups.pop();return delete s,!0}return!1},Scene3D.prototype.getScalar=function(t){return 1/(t.z/this.perspective+1)},Scene3D.prototype.project=function(){this.alphaScalar=(this.alphaFrontLimit-this.alphaBackLimit)/100;for(var t=0;t<this.groups.length;t++){var i=this.groups[t];i.project();for(var s=0;s<i.points.length;s++)i.points[s].project()}for(var t=0;t<this.groups.length;t++)for(var i=this.groups[t],o=0;o<i.objects.length;o++)i.objects[o].project()},Group3D.prototype.project=function(){for(var t=0;t<this.points.length;t++)this.points[t].localToGlobal()},Group3D.prototype.addPoint=function(t){this.points.push(t),t.group=this},Group3D.prototype.addLine=function(t){this.objects.push(t)},Group3D.prototype.addObject=function(){this.objects.push(tri)},Group3D.prototype.addGroup=function(){},Group3D.prototype.remove=function(){for(var t in this.points)this.points[t].movie.removeMovieClip();for(var t in this.objects)this.objects[t].movie.removeMovieClip();this.scene.removeGroup(this)},Group3D.prototype.setCenter=function(t){this.centerPoint=t},Group3D.prototype.getCenter=function(){return this.centerPoint},Group3D.prototype.translate=function(t,i,s){this.translation=new Translation3D(t,i,s),this.translation.transform(this.centerPoint),this.translation.transform(this)},Group3D.prototype.scale=function(t,i,s){this.xscale*=t,this.yscale*=i,this.zscale*=s,this.scaling=new Scaling3D(this.xscale,this.yscale,this.zscale);for(var o in this.axis)this.scaling.transform(this.axis[o])},Group3D.prototype.rotate=function(t,i){this.rotation=new Rotation3D(this.axis[t],i);for(var s in this.axis)this.rotation.transform(this.axis[s])},Group3D.prototype.rotateVector=function(t,i){this.rotation=new Rotation3D(t,i);for(var s in this.axis)this.rotation.transform(this.axis[s])},Group3D.prototype.transform=function(t){for(var i=0;i<this.points.length;i++)this.points[i].translate(-this.centerPoint.x,-this.centerPoint.y,-this.centerPoint.z),t.transform(this.points[i]),this.points[i].translate(this.centerPoint.x,this.centerPoint.y,this.centerPoint.z)},Point3D.prototype.localToGlobal=function(){var t=this.group.xscale*this.local.x,i=this.group.yscale*this.local.y,s=this.group.zscale*this.local.z;this.x=t*this.group.axis.x.x+i*this.group.axis.y.x+s*this.group.axis.z.x+this.group.x,this.y=t*this.group.axis.x.y+i*this.group.axis.y.y+s*this.group.axis.z.y+this.group.y,this.z=t*this.group.axis.x.z+i*this.group.axis.y.z+s*this.group.axis.z.z+this.group.z},Point3D.prototype.translate=function(t,i,s){this.x+=t,this.y+=i,this.z+=s},Point3D.prototype.project=function(){thisScene=this.group.scene;var t=thisScene.getScalar(this);this.xReal=this.x*t,this.yReal=-this.y*t,this.scaleReal=.76*t,this.alphaReal=(this.z-thisScene.alphaBackLimit)/thisScene.alphaScalar},Point3D.prototype.toString=function(t){null==t&&(t=10);var i=this.local;return""+[Math.round(i.x*t)/t,Math.round(i.y*t)/t,Math.round(i.z*t)/t].join(",")},Vector3D.prototype.toString=function(t){null==t&&(t=10);var i=this;return""+[Math.round(i.x*t)/t,Math.round(i.y*t)/t,Math.round(i.z*t)/t].join(",")},Rotation3D.prototype.transform=function(t){if(null!=t){var i=t.x*this.m_0_0+t.y*this.m_0_1+t.z*this.m_0_2,s=t.x*this.m_1_0+t.y*this.m_1_1+t.z*this.m_1_2,o=t.x*this.m_2_0+t.y*this.m_2_1+t.z*this.m_2_2;t.x=i,t.y=s,t.z=o}},Scaling3D.prototype.transform=function(t){if(null==t.scaleFactor&&(t.scaleFactor=1),t.scaleFactor!=this.factor){var i=this.factor/t.scaleFactor;t.x*=i,t.y*=i,t.z*=i,t.scaleFactor=this.factor}},Translation3D.prototype.transform=function(t){t.x+=this.distx,t.y+=this.disty,t.z+=this.distz};