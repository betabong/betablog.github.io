<!DOCTYPE html>
<html>
<head>
<title>Betablog: Simplicity follows Performance – parsing Strings in Actionscript 3</title>
<meta content='In my current project I do a lot of String parsing. Much a lot! And when it comes to do the same things many many times, performance will gain much from' name='description'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='True' name='HandheldFriendly'>
<meta content='320' name='MobileOptimized'>
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
<link href="/images/favicon.ico" rel="icon" type="image/ico" />
<link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />
</head>
<body class='post-template tag-getting-started'>
<main class='content' role='main'>
<article class='post tag-getting-started'>
<header class='post-header'>
<a class='blog-logo' href='/'>
<span class='blog-title'>Betablog</span>
</a>
</header>
<span class='post-meta'>
<time datetime='2008-09-01'>
01 Sep 2008
</time>
</span>
<h1 class='post-title'>Simplicity follows Performance – parsing Strings in Actionscript 3</h1>
<section class='post-content'><p>In my current project I do a lot of String parsing. Much a lot! And when it comes to do the same things many many times, performance will gain much from little details. Let&rsquo;s take the simplest parsing as an example. Converting a CSS like string <strong>&ldquo;width: 100%; maxwidth: 500; fontface: Bold; gap: 10;&rdquo;</strong> to an object <strong>{ width: &ldquo;100%&rdquo; , maxwidth: &ldquo;500&rdquo; , fontface: &ldquo;Bold&rdquo; , gap: &ldquo;10&rdquo; }</strong> Compare these two methods to achieve this: </p>
<pre class="highlight plaintext"><code>public static function simpleStringToObject_fast( input : String , o : Object = null ) : Object {
    if ( input == null || !Boolean(input) ) return o;
    if ( o == null ) o = {};

    var cursor : int = 0;
    var found_key : String;
    var index : int;
    while ( true ) {

        if ( found_key == null ) {
            index = input.indexOf( ':' , cursor );
            if ( index &gt;= 0 ) {
                while( input.charAt(index-1) == ' ' ) index--;
                found_key = input.substring( cursor , index );
                cursor = index + 1;
                while( input.charAt(cursor) == ' ' ) cursor++;
            } else {
                break;
            }
        } else {
            index = input.indexOf( ';' , cursor );
            if ( index &gt;= 0 ) {
                while( input.charAt(index-1) == ' ' ) index--;
                o[ found_key ] = input.substring( cursor , index );
                found_key = null;
                cursor = index + 1;
                while( input.charAt(cursor) == ' ' ) cursor++;
            } else {
                o[ found_key ] = input.substr( cursor );
                break;
            }
        }
    }

    return o;
}

public static function simpleStringToObject_slow( input : String , o : Object = null ) : Object {
    if ( input == null || !Boolean(input) ) return o;
    if ( o == null ) o = {};

    input = input.split(' ').join(''); // remove spaces
    var a : Array = input.split(';');
    var pair : Array;
    for ( var i:int=0 ; i 1 ) {
            o[ pair[0] ] = pair[1];
        }
    }
    return o;
}
</code></pre>

<p>The first one might look like some crap lacking any elegance and style, but it&rsquo;s** twice as fast** as the second one! And hey, if you do this a million times, it can be 5 seconds instead of 10. Might not seem to be that much, but I think it&rsquo;s certainly <strong>worth the extra coding</strong> :-) (Update: I haven&rsquo;t mentioned RegExp here, though it definitely deserves a mention. Thing is that Regular Expressions are just damned slow in Flash compared to String manipulations, especially with longer strings. This is kind of surprising because it&rsquo;s implemented natively. But the implementation obviously isn&rsquo;t too good performance wise. I hope to see improvements with F10, though haven&rsquo;t read anything about it yet - and also haven&rsquo;t tested yet with beta. This little article confirms my experience with RegExp: <a href="http://www.mischel.com/diary/2006/07/12.htm">With a file of 10,000 lines, the string version is still instantaneous, but the regular expression version takes about five seconds. Even with 180,000 lines, the string version is immediate. We gave up on the regular expression version after over five minutes..</a>)</p>

<h2>Comments</h2>

<p><strong><a title="2008-10-07 04:59:58" href="#5">Jeff</a>:</strong> Reading your code makes me want to puke. I really do.</p>

<p><strong><a title="2008-10-07 05:01:42" href="#6">Jeff</a>:</strong> Your code makes me want to vomit, both of them. The shorter one makes me want to vomit a little less so I will go with that, even if it is slower.</p>

<p><strong><a title="2009-09-21 21:38:30" href="#66">Kai</a>:</strong> I always appreciate breaking down algorithms to their smallest parts. It&rsquo;s a great exercise in self-improvement and speeds up the code every time. The hard part is balancing the time you spend vs the benefits of speed. What&rsquo;s up with JEFF?</p>
</section>
<footer class='post-footer'>
<section class='author'>
<h4>Severin Klaus</h4>
<p>@betabong.</p>
</section>
<section class='share'>
<h4>Share this post</h4>
<a class='icon-twitter' href='https://twitter.com/share?text=Simplicity follows Performance – parsing Strings in Actionscript 3&amp;amp;url=http://blog.betabong.com/2008/09/01/speed-parsing-string-in-as3/' onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
<span class='hidden'>Twitter</span>
</a>
<a class='icon-facebook' href='https://www.facebook.com/sharer/sharer.php?u=http://blog.betabong.com/2008/09/01/speed-parsing-string-in-as3/' onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
<span class='hidden'>Facebook</span>
</a>
<a class='icon-google-plus' href='https://plus.google.com/share?url=http://blog.betabong.com/2008/09/01/speed-parsing-string-in-as3/' onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
<span class='hidden'>Google+</span>
</a>
</section>
</footer>
</article>
</main>

<footer class='site-footer'>
<a class='subscribe icon-feed' href='/feed.xml'>
<span class='tooltip'>Subscribe!</span>
</a>
<div class='inner'>
<section class='copyright'>
All content copyright
<a href="/">Betablog</a>
&copy;
2015
&bull; All rights reserved.
</section>
<section class='poweredby'>
Proudly published with
<a href='http://middlemanapp.com'>Middleman</a>
</section>
<section class='poweredby'>
Casper theme powered by
<a class='icon-ghost' href='https://ghost.org'>Ghost</a>
</section>
</div>
</footer>
<link href='//fonts.googleapis.com/css?family=Old+Standard+TT:400,400italic,700' rel='stylesheet' type='text/css'>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-359384-6', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
